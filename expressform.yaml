env:
  contexts:
    -
      includePaths:
        - http://13.212.48.92:4003.*
      name: Default Context
      urls:
        - http://13.212.48.92:4003
      authentication:
        method: form
        parameters:
          loginPageUrl: http://13.212.48.92:4003/api/auth/login
          loginRequestBody: username={%username%}&password={%password%}
          loginRequestUrl: http://13.212.48.92:4003/api/auth/login
        verification:
          method: poll
          loggedInRegex: dashboard|success|token
          loggedOutRegex: login|unauthorized|logout
          pollFrequency: 60
          pollUnits: requests
          pollUrl: http://13.212.48.92:4003/api/auth/login
      sessionManagement:
        method: cookie
        parameters: {}
      users:
        - credentials:
            username: rajif@gmail.com
            password: mypassword
          name: authentication user
  vars: {}
  parameters:
    failOnError: true
    failOnWarning: false
    progressToStdout: true
    timeout: 300

jobs:
  - name: passiveScan-config
    parameters:
      scanOnlyInScope: true
      enableTags: false
    type: passiveScan-config

  # optional, comment if /swagger invalid
  # - name: openapi
  #   parameters:
  #     definitionUrl: http://13.212.48.92:4003/swagger
  #     context: Default Context
  #   type: openapi

  - name: passiveScan-wait
    parameters: {}
    type: passiveScan-wait

  - name: activeScan
    parameters:
      context: Default Context
      threadPerHost: 4
      user: authentication user
    policyDefinition:
      rules: []
    type: activeScan
